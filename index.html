<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meeting Minutes Timer</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div style="display: flex; flex-direction: row; height: 100vh;">
        <!-- Sidebar for text expansions -->
        <div id="expanderSidebar" style="width: 80px; background: #f7f7f7; border-right: 1px solid #ddd; padding: 8px 4px; display: flex; flex-direction: column; align-items: stretch;">
            <div style="font-weight: bold; font-size: 12px; margin-bottom: 8px; text-align: center;">Expansions</div>
            <div id="expanderList" style="display: flex; flex-direction: column; gap: 4px;"></div>
        </div>
        <div style="flex: 1;">
            <div class="header">
        <div class="controls">
            <div class="control-group">
                <label>Meeting Title:</label>
                <input type="text" id="meetingTitle" placeholder="Land Use Committee Meeting" style="width: 300px;">
            </div>
            
            <div class="control-group">
                <label>Recording URL:</label>
                <input type="text" id="recordingUrl" placeholder="https://youtu.be/..." style="width: 300px;">
            </div>
            
            <div class="control-group">
                <label>Start Time:</label>
                <input type="datetime-local" id="startTime">
            </div>
            
            <button onclick="setStartTimeNow()">Set to Now</button>
            
            <div class="toggle-container">
                <label>Auto-timestamp on Enter:</label>
                <div class="toggle" id="autoTimestampToggle" onclick="toggleAutoTimestamp()">
                    <div class="toggle-slider"></div>
                </div>
            </div>
            
            <button onclick="insertTimestamp()" style="background: #106e1a;">Insert Timestamp (⌘;)</button>
            <button class="secondary" onclick="processTimestamps()">Process Timestamps → YouTube Links</button>
            <button class="secondary" onclick="processFootnotes()">Add Footnotes</button>
            <button class="secondary" onclick="copyAsHTML()">Copy as HTML for Google Docs</button>
            <button class="secondary" onclick="downloadMarkdown()">Download Markdown</button>
            <button class="secondary" onclick="downloadPython()">Download Python Script</button>
            <button class="secondary" onclick="toggleFootnotes()">Manage Footnotes</button>
        </div>
        
        <div>
            <div class="collapsible" onclick="toggleQuickInsert()">
                <span class="arrow" id="quickInsertArrow">▶</span>
                <span>Quick Insert Templates</span>
            </div>
            <div id="quickInsertPanel" style="display: none; margin-top: 10px;">
                <div class="quick-insert">
                    <div class="quick-insert-section">
                        <div class="quick-insert-label">Structure</div>
                        <div class="quick-buttons">
                            <button class="quick" onclick="insertAgenda()">Full Agenda</button>
                        </div>
                    </div>
                    
                    <div class="quick-insert-section">
                        <div class="quick-insert-label">Common Phrases</div>
                        <div class="quick-buttons">
                            <button class="quick" onclick="insertPhrase('callToOrder')">Call to Order</button>
                            <button class="quick" onclick="insertPhrase('quorum')">Quorum</button>
                            <button class="quick" onclick="insertPhrase('adopted')">Adopted w/o Objection</button>
                            <button class="quick" onclick="insertPhrase('motion')">Motion</button>
                            <button class="quick" onclick="insertPhrase('carried')">Motion Carried</button>
                            <button class="quick" onclick="insertPhrase('failed')">Motion Failed</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="editor-container">
        <textarea id="editor" placeholder="Paste your meeting agenda here and start taking notes...

    Example:
    1. Call to Order
    2. Presentation
       - Topic overview
    3. Questions

    Press ⌘; to insert timestamp, or enable auto-timestamp to insert on every Enter press."></textarea>
    </div>
    
    <div class="footer">
        <div class="shortcuts">
            <div class="shortcut">
                <kbd>⌘;</kbd>
                <span>Insert Timestamp</span>
            </div>
            <div class="shortcut">
                <kbd>⌘S</kbd>
                <span>Download Markdown</span>
            </div>
            <div class="shortcut">
                <kbd>⌘P</kbd>
                <span>Process Timestamps</span>
            </div>
            <div class="shortcut">
                <kbd>⌘F</kbd>
                <span>Add Footnotes</span>
            </div>
        </div>
        <div id="status">Ready</div>
    </div>

    <script src="constants.js"></script>
    <script src="app.js"></script>
    <script>
    // Dynamically render text expander sidebar
    window.addEventListener('DOMContentLoaded', function() {
        if (window.TEXT_EXPANDERS) {
            const expanderList = document.getElementById('expanderList');
            expanderList.innerHTML = '';
            Object.entries(TEXT_EXPANDERS).forEach(([key, value]) => {
                const btn = document.createElement('button');
                btn.textContent = value.length > 18 ? value.slice(0, 18) + '…' : value;
                btn.title = value;
                btn.style.fontSize = '11px';
                btn.style.padding = '2px 4px';
                btn.style.margin = '0';
                btn.style.borderRadius = '3px';
                btn.style.border = '1px solid #ccc';
                btn.style.background = '#fff';
                btn.style.cursor = 'pointer';
                btn.onclick = function() {
                    const editor = document.getElementById('editor');
                    const start = editor.selectionStart;
                    const text = editor.value;
                    editor.value = text.substring(0, start) + value + text.substring(start);
                    editor.selectionStart = editor.selectionEnd = start + value.length;
                    editor.focus();
                };
                expanderList.appendChild(btn);
            });
        }
    });
    </script>
</body>
</html>